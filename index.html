<!DOCTYPE html>
<html>

<head>
    <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
    <title>Mining Industry in Australia</title>

    <link rel="stylesheet" type="text/css" href="css/style.css" media="all">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Luxurious+Script&family=Special+Elite&display=swap" rel="stylesheet">
</head>

<body>
    <!-- <h1>An Exploration of Mining Industry in Australia</h1> -->
    <section class="container">
        <!-- Left-aligned text -->
        <div class="left">
          <p>Exploration of <br><span class="colored-text">Mining Industry</span></p>
        </div>
    
        <!-- Center image -->
        <div class="image">
          <img src="coal-mine.png" alt="Mining Image">
        </div>
    
        <!-- Right-aligned text -->
        <div class="right">
          <p><span class="colored-text">Australia</span><br>2013 - 2022</p>
        </div>
    </section>

    <div class="short-intro">
        <p>Australia’s mining industry is a global leader, contributes significantly to the economy
            and shaping future exploration. 
            This visualization highlights key trends from 2013 to 2022, 
            showcasing <a href="#dominance" style="text-decoration: underline;">Australia’s dominance</a>, 
            <a href="#state_map" style="text-decoration: underline;">state contributions</a>, 
            and the <a href="#minerals" style="text-decoration: underline;">minerals matter most</a>.
        </p>
    </div>
    <section>
        <h2 id="dominance">#1: Australia Leads the World in Mining Revenue</h2>
        <br><div id="top_country"></div>
    </section>

    <section id="exp-dms">
        <h2>#2: Mining Growth: Exports Fuel Australia’s Economy</h2>
        <br><div id="export-domestic"></div>
    </section>

    <section>
        <h2>#3: State Contributions: Which Regions Drive Mining?</h2>
        <div>
        <div id="state_map"></div>
        <div id="state"></div>
            <!-- Filter Dropdown -->
            <label for="regionFilter">Filter by Region:</label>
            <select id="regionFilter">
                <option value="All">All</option>
                <option value="NSW">NSW</option>
                <option value="VIC">VIC</option>
                <option value="QLD">QLD</option>
                <option value="SA">SA</option>
                <option value="WA">WA</option>
                <option value="TAS">TAS</option>
                <option value="Northern Territory">Northern Territory</option>
            </select>
        </div>
    </section>

    <section>
        <h2 id="minerals">#4: What Minerals Matter Most to Australia?</h2>
        <br><div id="mineral"></div>
    </section>

    <button onclick="topFunction()" id="myBtn" title="Go to top">↑</button>

    <script type="text/javascript">
        var spec1 = "js/symbol_map.vg.json";
        vegaEmbed('#style', spec1, {renderer: "svg", actions: false}).then(function (result) {
            // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        }).catch(console.error);

        var spec2 = "js/stacked_area.vg.json";
        vegaEmbed('#styling', spec2).then(function (result) {
            // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        }).catch(console.error);

        var spec3 = "js/dual_axis.vg.json";
        vegaEmbed('#dual', spec3).then(function (result) {
            // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        }).catch(console.error);

        var spec4 = "js/tree_map.vg.json";
        vegaEmbed('#energy', spec4).then(function (result) {
            // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        }).catch(console.error);

        // var spec5 = "js/state_map.vg.json";
        // vegaEmbed('#state_map', spec5).then(function (result) {
        //     // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        // }).catch(console.error);

        var spec6 = "js/top_country.vg.json";
        vegaEmbed('#top_country', spec6).then(function (result) {
            // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        }).catch(console.error);

        var spec7 = "js/export-domestic.vg.json";
        vegaEmbed('#export-domestic', spec7).then(function (result) {
            // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        }).catch(console.error);

        // var spec8 = "js/state.vg.json";
        // vegaEmbed('#state', spec8).then(function (result) {
        //     // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        // }).catch(console.error);

        var spec9 = "js/mineral.vg.json";
        vegaEmbed('#mineral', spec9).then(function (result) {
            // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        }).catch(console.error);

            // Function to update both Vega charts
        function updateVegaWithFilter(filterValue) {
            const specStateMap = "js/state_map.vg.json";
            const specState = "js/state.vg.json";

            // Load state map visualization and apply filter
            vegaEmbed('#state_map', specStateMap, { renderer: "svg" }).then(function(result) {
                result.view.signal("regionFilter", filterValue).run();
            }).catch(console.error);

            // Load state visualization and apply filter
            vegaEmbed('#state', specState, { renderer: "svg" }).then(function(result) {
                result.view.signal("regionFilter", filterValue).run();
            }).catch(console.error);
        }

        // Add event listener to dropdown
        document.getElementById('regionFilter').addEventListener('change', function(event) {
            const selectedRegion = event.target.value;
            updateVegaWithFilter(selectedRegion);
        });

        // Initial load of both charts with 'All' selected by default
        updateVegaWithFilter('All');


        // Get the button:
        let mybutton = document.getElementById("myBtn");

        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            mybutton.style.display = "block";
        } else {
            mybutton.style.display = "none";
        }
        }

        // When the user clicks on the button, scroll to the top of the document
        function topFunction() {
        document.body.scrollTop = 0; // For Safari
        document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
    
    </script>

</body>

</html>