{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 500,
  "height": 300,
  "background": "rgba(0, 0, 0, 0)",
  "data": {
    "url": "https://raw.githubusercontent.com/dlnphng/a2-data-viz/main/data/export-domestic.csv",
    "format": {
      "type": "csv"
    }
  },
  "params": [
    {
      "name": "typeFilter",
      "value": "All",
      "bind": {
        "input": "select",
        "options": ["All", "Domestic consumption", "Total export"],
        "labels": ["All", "Domestic", "Export"],
        "name": "Filter by Type: "
      }
    }
  ],
  "transform": [
    {
      "filter": "typeFilter === 'All' || datum.Type === typeFilter"
    }
  ],
  "encoding": {
    "x": {
      "field": "Year",
      "type": "ordinal",
      "axis": {
        "title": null,
        "labelAngle": 0,
        "labelColor": "white",
        "labelFont": "Outfit"
      },
      "scale": {
        "domain": [2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022],
        "padding": 0
      }
    },
    "y": {
      "field": "Value",
      "type": "quantitative",
      "axis": {
        "title": "Total Mining Revenue (Million $)",
        "titleColor": "white",
        "titleFont": "Outfit",
        "labelColor": "white",
        "labelFont": "Outfit"
      }
    },
    "color": {
      "field": "Type",
      "type": "nominal",
      "scale": {
        "domain": ["Domestic consumption", "Total export"],
        "range": ["#808080", "#fff9b0"]
      },
      "legend": {
        "title": "Type",
        "labelFont": "Outfit",
        "titleColor": "white",
        "labelColor": "white"
      }
    },
    "tooltip": [
      {"field": "Year", "type": "ordinal", "title": "Year"},
      {"field": "Type", "type": "nominal", "title": "Type"},
      {"field": "Value", "type": "quantitative", "title": "Total ($ million)"}
    ],
    "order": {
      "field": "Type",
      "type": "nominal",
      "sort": "descending"
    }
  },
  "layer": [
    {
      "mark": {
        "type": "area"
      }
    },
    {
      "transform": [
        {
          "filter": "typeFilter === 'Total export'"
        }
      ],
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "dx": 5,
        "dy": -10,
        "color": "white",
        "font": "Outfit",
        "fontSize": 12
      },
      "encoding": {
        "x": {"datum": "2014"},
        "y": {"datum": 160},
        "text": {"value": "Decrease in export demand"}
      }
    },
    {
      "transform": [
        {
          "filter": "typeFilter === 'All'"
        }
      ],
      "mark": {
        "type": "text",
        "align": "right",
        "baseline": "middle",
        "dx": -5,
        "dy": -10,
        "color": "red",
        "font": "Outfit",
        "fontSize": 12
      },
      "encoding": {
        "x": {"datum": "2022"},
        "y": {"datum": 600},
        "text": {"value": "New peak in 2022"}
      }
    }
  ]
}
